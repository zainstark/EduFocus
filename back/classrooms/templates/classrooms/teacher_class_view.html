{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ classroom.name }} - Teacher View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <!-- Class Info -->
    <div class="card mb-4">
        <div class="card-body">
            <h1>{{ classroom.name }}</h1>
            <p><strong>Class Code:</strong> {{ classroom.code }}</p>
            <p>{{ classroom.description|default:"No description" }}</p>
        </div>
    </div>

    <!-- Stats Overview -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5>Number of Sessions</h5>
                    <h3>{{ sessions.count }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5>Students Enrolled</h5>
                    <h3>{{ students|length }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5>Last Session Attendance</h5>
                    <h3>{{ last_session_attendance|default:"0" }}%</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5>Avg Focus (Last Session)</h5>
                    <h3>{{ last_session_avg_focus|default:"0" }}%</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Focus Performance Graph -->
    <div class="card mb-4">
        <div class="card-header">
            <h4>Average Focus Performance Per Session</h4>
        </div>
        <div class="card-body">
            <canvas id="focusChart" height="120"></canvas>
        </div>
    </div>

    <!-- Focus vs Time Graph (Last Lecture) -->
    <div class="card">
        <div class="card-header">
            <h4>Focus vs Time (Last Lecture)</h4>
        </div>
        <div class="card-body">
            <canvas id="focusTimeChart" height="120"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Focus per session chart
const ctx1 = document.getElementById('focusChart').getContext('2d');
new Chart(ctx1, {
    type: 'line',
    data: {
        labels: {{ session_labels_json|safe }},
        datasets: [{
            label: 'Avg Focus %',
            data: {{ session_avg_focus_data_json|safe }},
            borderColor: '#0d6efd',
            fill: false
        }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true, max: 100 } } }
});

// Focus vs time chart for last lecture
const ctx2 = document.getElementById('focusTimeChart').getContext('2d');
new Chart(ctx2, {
    type: 'line',
    data: {
        labels: {{ last_session_time_points_json|safe }},
        datasets: [{
            label: 'Focus %',
            data: {{ last_session_focus_values_json|safe }},
            borderColor: '#dc3545',
            fill: false
        }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true, max: 100 } } }
});
</script>
</body>
</html>
